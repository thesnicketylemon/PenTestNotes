## Directory (File Path) Traversal Attacks
These attacks allow an attacker to read arbitrary files that are located on the server running the application.

### How to create an attack
1. Find out whether it is a Unix server or a Windows based server
2. See if any images or files are being served from the server e.g. images would be served from `/var/www/images` 
for some servers.
3. Use directory traversal like to move across directories. Trying getting access to password files, admin files etc.
   1. Try doing the usual `../../` to see if there is any validation happening on the server
   2. If the server requires an absolute path, just do `/etc/passwd` or something to get the file
   3. If there is a non-recursive removal happening, try `....//....//` or `....\/....\/` to avoid the removal 
   4. If there is a recursive removal, then use a double-UTF encoding like `%252f` for the `/` character or `%c0%af`
   [link](https://flylib.com/books/en/2.819.1.43/1/)
   5. If the application requires some directory structure, provide that directory structure and then do some directory
   traversal e.g. if the server requires `/var/www/images`, then do `/var/www/images/../../../etc/passwd`
   6. If the application requires a specific file-extension, give a null byte `%00` to effectively terminate the path 
   and then give the file-extension

### Prevention
1. Avoid passing user-supplied input to filesystem APIs.
2. If needed, then:
   1. Validate the user input before processing it. The validation should compare against a whitelist of permitted values. 
   If that isn't possible for the required functionality, then the validation should verify that the input contains 
   only permitted content, such as purely alphanumeric characters. 
   2. Append the input to the base directory and use a platform filesystem API to canonicalize the path. Verify that the
   canonicalized path starts with the expected base directory.