# Business Logic Vulnerabilities
Business logic vulnerabilities happen because of assumptions made by the development team on how a user
will interact with an application.

## Examples
### Server trusting client-side controls
If an application assumes that a client will interact with the API through a web browser, then sending raw CURL requests
and changing the value of cookies or the body wouldn't be validated by the server.

### Allowing brute-force attempts on passwords, token, security codes
If an application doesn't stop brute-force attempts to find a password or security code, then an attacker can use that
to get a password
Suggestions for brute-force:
1. For numbers, check behaviour for negative numbers, max values of ints and floats and string as input
2. For strings, use short strings, abnormally long strings, non-UTF-8 encoded characters
3. For emails, check for abnormally large email value and see if any truncation is happening.
4. Magic numbers include 255, 32767, 65535. Use the following code snippet to generate these values:
```
cat /dev/urandom | tr -dc 'a-z0-9' | fold -w 255 | head -n 1
```

During recon, make sure to answer these questions for input:
1. Are there any limits that are imposed on the data?
2. What happens when you reach those limits? 
3. Is any transformation or normalization being performed on your input?
4. Check `/admin` page to see if it is accessible or if there are any breadcrumbs that you can use.

### Assumptions about user behaviour
1. No defense-in-depth, which can lead to privilege escalation because of inconsistent security controls
2. Parameters that are mandatory on the browser are not mandatory on the server-side. So removing some parameters and seeing 
    what the response would be like.
   1. Only remove one parameter at a time to ensure all relevant code paths are reached. 
   2. Try deleting the name of the parameter as well as the value. The server will typically handle both cases differently. 
   3. Follow multi-stage processes through to completion. Sometimes tampering with a parameter in one step will 
   have an effect on another step further along in the workflow.
   4. Check the URL, POST, GET requests and Cookies too

### Assumptions about sequence of user interactions
1. Check if you can bypass 2FA by going to another page after logging in
2. Drop requests in the sequence and see if the state of the website changes
3. The Discount functionality and the Gift Code functionality are likely to have logic flaws.
4. Read as much documentation as possible and, where available, talk to subject-matter experts from 
the domain to get their insight. 

